- Tool used for cracking passwords through various attacks including Brute Forcing and Dictionary Attacks. 

**Single Crack Mode:**
- Rule-based cracking technique that is useful for Linux Credentials.
- John takes in username information and generates likely password candidates based on the username provided. 

Let's say we obtain the following line from the target Linux /etc/passwd file: 

```
r0lf:$6$ues25dIanlctrWxg$nZHVz2z4kCy1760Ee28M1xtHdGoy0C2cYzZ8l2sVa1kIa8K9gAcdBP.GI6ng/qA4oaMrgElZ1Cb9OeXO4Fvy3/:0:0:Rolf Sebastian:/home/r0lf:/bin/bash
```

**The above line is a combination of the passwd and shadow file, please see below on steps to create it:**
```
sudo unshadow /etc/passwd /etc/shadow > mypassword_hashes
```

Based on the information, we now can run John the Ripper against that file in single crack mode to see if John can come up with a password. 

```shell-session
realCustampin@htb[/htb]$ john --single passwd

Using default input encoding: UTF-8
Loaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
[...SNIP...]        (r0lf)     
1g 0:00:00:00 DONE 1/3 (2025-04-10 07:47) 12.50g/s 5400p/s 5400c/s 5400C/s NAITSABESFL0R..rSebastiannaitsabeSr
Use the "--show" option to display all of the cracked passwords reliably
Session completed.
```
- As we can see, the password hash was successfully cracked. 

**Wordlist Mode:**
- Used to crack passwords with a wordlist that is provided. 
- Syntax is shown below: 
```shell-session
realCustampin@htb[/htb]$ john --wordlist=<wordlist_file> <hash_file>
```

The wordlist file must be in plaintext and one password per line. 

**Incremental Mode:**
- Powerful brute-forcing style password cracking mode that generates candidate passwords based on a statistical model. 
- Basic syntax show below: 
```shell-session
realCustampin@htb[/htb]$ john --incremental <hash_file>
```

## Identifying Hash Formats
- Sometimes we may come across some hashes that may not be in a well known format, if that's the case then we have a few options: 
	- https://pentestmonkey.net/cheat-sheet/john-the-ripper-hash-formats
	- https://openwall.info/wiki/john/sample-hashes
	- HashID

Using hashID: 


```shell-session
realCustampin@htb[/htb]$ hashid -j 193069ceb0461e1d40d216e32c79c704

Analyzing '193069ceb0461e1d40d216e32c79c704'
[+] MD2 [JtR Format: md2]
[+] MD5 [JtR Format: raw-md5]
[+] MD4 [JtR Format: raw-md4]
[+] Double MD5 
[+] LM [JtR Format: lm]
[+] RIPEMD-128 [JtR Format: ripemd-128]
[+] Haval-128 [JtR Format: haval-128-4]
[+] Tiger-128 
[+] Skein-256(128) 
[+] Skein-512(128) 
[+] Lotus Notes/Domino 5 [JtR Format: lotus5]
[+] Skype 
[+] Snefru-128 [JtR Format: snefru-128]
[+] NTLM [JtR Format: nt]
[+] Domain Cached Credentials [JtR Format: mscach]
[+] Domain Cached Credentials 2 [JtR Format: mscach2]
[+] DNSSEC(NSEC3) 
[+] RAdmin v2.x [JtR Format: radmin]
```
- We can supply a hash and we can also pass the -j argument to allow us to get the John the Ripper hash format. 

**Cracking Files:**
- It is also possible to crack password-protected or encrypted files with JtR. 
Usage: 
```shell-session
realCustampin@htb[/htb]$ <tool> <file_to_crack> > file.hash
```

|**Tool**|**Description**|
|---|---|
|`pdf2john`|Converts PDF documents for John|
|`ssh2john`|Converts SSH private keys for John|
|`mscash2john`|Converts MS Cash hashes for John|
|`keychain2john`|Converts OS X keychain files for John|
|`rar2john`|Converts RAR archives for John|
|`pfx2john`|Converts PKCS#12 files for John|
|`truecrypt_volume2john`|Converts TrueCrypt volumes for John|
|`keepass2john`|Converts KeePass databases for John|
|`vncpcap2john`|Converts VNC PCAP files for John|
|`putty2john`|Converts PuTTY private keys for John|
|`zip2john`|Converts ZIP archives for John|
|`hccap2john`|Converts WPA/WPA2 handshake captures for John|
|`office2john`|Converts MS Office documents for John|
|`wpa2john`|Converts WPA/WPA2 handshakes for John|
|...SNIP...|...SNIP...|
## Lab Questions

1. Use single-crack mode to crack r0lf's password
	1. NAITSABES
2. Use wordlist-mode with rockyou.txt to crack the RIPEMD-128 password.
	1. 50cent